# 2026-02-15 — Board.scan() + measurement_height

## Work Done

### Board.scan()
- Added `scan(plate, method)` to the `Board` class in `src/protocol_engine/board.py`
- **Instrument is inferred** from the bound method via `method.__self__`
- For each well in **row-major order** (A1, A2, ..., B1, B2, ...):
  1. Adjusts the well's z by the instrument's `measurement_height`
  2. Moves the gantry so the instrument is positioned at that height over the well
  3. Calls `method(plate)` passing the wellplate, records the bool result
- Returns `Dict[str, bool]` mapping each well ID to success/failure

### measurement_height on BaseInstrument
- Added `measurement_height: float = 0.0` to `BaseInstrument.__init__`
- Represents the z-offset relative to the well position the instrument needs for its operation
- `scan` applies it as: `target_z = well.z + instrument.measurement_height`
- `Board.move()` then further adjusts for the instrument's physical `depth`

### Usage
```python
sensor = Sensor(measurement_height=3.0, depth=-1.0, ...)
board.scan(plate, sensor.measure)
# For each well at z=-5.0:
#   target_z = -5.0 + 3.0 = -2.0
#   gantry_z = -2.0 - (-1.0) = -1.0
```

## Tests
- 13 scan tests in `tests/protocol_engine/test_board.py` (TestBoardScan)
- 1 new test in `tests/instruments/test_base_instrument.py` for measurement_height
- All 65 tests pass (base_instrument + board)

## Issues Found & Resolved
- **Python 3.9 compatibility**: `src/deck/yaml_schema.py` used `_YamlPoint3D | None` (3.10+). Fixed with `Optional[_YamlPoint3D]`.

## Files Modified
- `src/instruments/base_instrument.py` — added `measurement_height` parameter
- `src/protocol_engine/board.py` — added `scan()`, `_resolve_instrument_from_method()`, `_row_major_key()`
- `tests/protocol_engine/test_board.py` — added `_FakeSensor`, `TestBoardScan` (13 tests)
- `tests/instruments/test_base_instrument.py` — added measurement_height test
- `src/deck/yaml_schema.py` — fixed Python 3.9 compatibility
