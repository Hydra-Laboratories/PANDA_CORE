# 2026-02-12 — UV-Vis CCS Spectrometer Instrument Driver

## Summary

Ported the Thorlabs CCS100 UV-Vis spectrometer driver from `mofcat-workflow-main/devices/ccs100.py` into PANDA_CORE using the `BaseInstrument` abstraction pattern.

## Work Done

### New files created: `src/instruments/uvvis_ccs/`

| File | Purpose |
|------|---------|
| `exceptions.py` | `UVVisCCSError` hierarchy (Connection, Measurement, Timeout) |
| `models.py` | `UVVisSpectrum` frozen dataclass with `is_valid` / `num_pixels` |
| `driver.py` | `UVVisCCS(BaseInstrument)` — real DLL driver via ctypes |
| `mock.py` | `MockUVVisCCS(BaseInstrument)` — test double with `command_history` |
| `__init__.py` | Public exports |

### New test file: `tests/test_uvvis_ccs.py`
- 30 tests covering: model validation, exception hierarchy, synthetic spectrum helper, driver lifecycle (mocked ctypes), measure flow, mock command tracking
- All 30 pass; 46 existing tests unaffected

### Documentation updates
- `src/instruments/README.md` — new file listing all instruments with vendor labels
- `AGENTS.md` — added uvvis_ccs section
- `README.md` — added usage example for UVVisCCS

## Key Design Decisions

- **DLL loading deferred to `connect()`** — original mofcat code loaded the DLL at module import time; now it's lazy and testable
- **`measure()` returns `UVVisSpectrum` dataclass** — instead of a raw `(wavelengths, intensities)` tuple
- **Errors wrapped in typed hierarchy** — `UVVisCCSTimeoutError` replaces bare `RuntimeError`
- **Wavelengths stored as `tuple[float, ...]`** — no numpy dependency; keeps the instrument driver pure Python
- **Constructor params instead of hardcoded config** — serial number, DLL path, integration time all configurable

## What Was Left Out (intentionally)
- Gantry positioning — PANDA_CORE has its own gantry
- Google Sheets logging — workflow-level, not instrument-level
- Scan scheduling / orchestration — belongs in protocol engine
